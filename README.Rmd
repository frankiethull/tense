---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# tense


```{r}
library(tense)
library(ggplot2)

t <- seq(0, 20, by = 0.5)
y <- sin(t) * 10
train <- y[1:(length(y) - 10)]
test <- y[(length(y) - 9):length(y)]

```

initialize, fit, and predict with an llm:
```{r}

# spec:
model_spec <- tense_init(
  model_name = "gpt-oss:20b",
  context_window = 30,
  temperature = 0.90
)

# fit
model <- tense_fit(model_spec, train)

# predict
forecast <- tense_predict(model, h = 10)

```

comparison of data and lexicon: 
```{r}
last_seen_data <- tail(model$history, 5)
last_seen_words <- tense:::encode_sentiment(last_seen_data, model$lexicon)

cat("\n--- The Model's Inner Monologue ---\n")
cat("Last 5 Inputs: ", paste(last_seen_words, collapse = " -> "), "\n")
cat(
  "Numerical Value:",
  paste(round(tail(train, 5), 2), collapse = " -> "),
  "\n"
)

```

compare the predictions:
```{r}
df_plot <- rbind(
  data.frame(Time = 1:length(train), Value = train, Type = "History"),
  data.frame(
    Time = (length(train) + 1):(length(train) + 10),
    Value = test,
    Type = "Actual"
  ),
  data.frame(
    Time = (length(train) + 1):(length(train) + 10),
    Value = forecast,
    Type = "Forecast"
  )
)

ggplot(df_plot, aes(x = Time, y = Value, color = Type)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  theme_minimal() +
  scale_color_manual(
    values = c("History" = "gray", "Actual" = "black", "Forecast" = "purple")
  ) +
  labs(
    title = "tense results",
    subtitle = "semantic TimeLLM forecast: gpt-oss:20b, t=0.90, window=30",
    y = "Signal Value"
  )

```



initialize, fit, and predict with an llm:
```{r}

# spec:
model_spec <- tense_init(
  model_name = "gpt-oss:20b",
  context_window = 20,
  temperature = 0.20
)

# fit
model <- tense_fit(model_spec, train)

# predict
forecast <- tense_predict(model, h = 10)

```

comparison of data and lexicon: 
```{r}
last_seen_data <- tail(model$history, 5)
last_seen_words <- tense:::encode_sentiment(last_seen_data, model$lexicon)

cat("\n--- The Model's Inner Monologue ---\n")
cat("Last 5 Inputs: ", paste(last_seen_words, collapse = " -> "), "\n")
cat(
  "Numerical Value:",
  paste(round(tail(train, 5), 2), collapse = " -> "),
  "\n"
)

```

compare the predictions:
```{r}
df_plot <- rbind(
  data.frame(Time = 1:length(train), Value = train, Type = "History"),
  data.frame(
    Time = (length(train) + 1):(length(train) + 10),
    Value = test,
    Type = "Actual"
  ),
  data.frame(
    Time = (length(train) + 1):(length(train) + 10),
    Value = forecast,
    Type = "Forecast"
  )
)

ggplot(df_plot, aes(x = Time, y = Value, color = Type)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  theme_minimal() +
  scale_color_manual(
    values = c("History" = "gray", "Actual" = "black", "Forecast" = "purple")
  ) +
  labs(
    title = "tense results",
    subtitle = "semantic TimeLLM forecast: gpt-oss:20b, t=0.20, window=20",
    y = "Signal Value"
  )

```
